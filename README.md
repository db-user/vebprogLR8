# Auto Parts API

Цей проект реалізує систему для управління товарами автомобільних запчастин з функціями автентифікації та авторизації на основі JWT. Проект складається з двох основних частин: **Backend** (FastAPI) та **Frontend** (React).

## Зміст

- [Опис проекту](#опис-проекту)
- [Технічні деталі](#технічні-деталі)
- [Встановлення та запуск](#встановлення-та-запуск)
  - [Запуск бекенду](#запуск-бекенду)
  - [Запуск фронтенду](#запуск-фронтенду)
  - [Контейнеризація (Docker)](#контейнеризація-docker)
- [Структура проекту](#структура-проекту)
- [Тести](#тести)
- [Використання](#використання)
- [Ліцензія](#ліцензія)

## Опис проекту

Цей проект надає REST API для роботи з базою даних автомобільних запчастин. Користувачі можуть виконувати CRUD операції для категорій і товарів. Система підтримує автентифікацію та авторизацію за допомогою JWT токенів, що дозволяє контролювати доступ до різних ендпоінтів в залежності від ролі користувача (адмін, користувач, модератор).

Основні функції:
- Реєстрація користувачів
- Вхід за допомогою JWT токенів
- Доступ до товарів і категорій в залежності від ролі користувача
- Оновлення токенів (refresh token)
- Перевірка паролів на складність

## Технічні деталі

- **Backend**: Python 3.9+, FastAPI, SQLAlchemy, Alembic, JWT, Pydantic
- **Frontend**: React, Axios
- **База даних**: PostgreSQL (можна налаштувати в конфігураціях)
- **Аутентифікація**: JSON Web Tokens (JWT)
- **Тестування**: Pytest

## Встановлення та запуск

### Запуск бекенду

1. Клонувати репозиторій:
    ```bash
    git clone https://github.com/your-username/auto-parts-api.git
    cd auto-parts-api
    ```

2. Створити віртуальне середовище та активувати його:
    ```bash
    python -m venv venv
    source venv/bin/activate  # для Linux/MacOS
    venv\Scripts\activate     # для Windows
    ```

3. Встановити залежності:
    ```bash
    pip install -r requirements.txt
    ```

4. Налаштувати файл середовища `.env` (приклад в `.env.example`):
    ```ini
    SECRET_KEY=your_secret_key
    DATABASE_URL=postgresql://user:password@localhost/dbname
    ```

5. Ініціалізувати базу даних:
    ```bash
    python init_db.py
    ```

6. Запустити сервер FastAPI:
    ```bash
    uvicorn app.main:app --reload
    ```

   Сервер буде доступний за адресою: `http://localhost:8000`

### Запуск фронтенду

1. Перейти до папки фронтенду:
    ```bash
    cd frontend
    ```

2. Встановити залежності:
    ```bash
    npm install
    ```

3. Запустити сервер React:
    ```bash
    npm start
    ```

   Фронтенд буде доступний за адресою: `http://localhost:3000`

### Контейнеризація (Docker)

1. Побудувати Docker образ:
    ```bash
    docker-compose build
    ```

2. Запустити контейнерами:
    ```bash
    docker-compose up
    ```

   Контейнеризований додаток буде доступний за адресами:
   - Бекенд: `http://localhost:8000`
   - Фронтенд: `http://localhost:3000`

## Структура проекту
auto-parts-api/
├── app/                            # Основний код додатку
│   ├── __init__.py                 # Порожній файл для позначення директорії як пакет
│   ├── main.py                     # Точка входу в додаток (FastAPI)
│   ├── api/                        # Маршрути (ендпоінти) API
│   │   ├── __init__.py             # Порожній файл для позначення директорії як пакет
│   │   ├── endpoints/              # Різні ендпоінти (категорії, товари, аутентифікація)
│   │   │   ├── items.py            # Маршрути для роботи з товарами
│   │   │   ├── categories.py       # Маршрути для роботи з категоріями
│   │   │   └── auth.py             # Маршрути для аутентифікації (реєстрація, вхід, авторизація)
│   ├── crud/                       # Операції з БД
│   │   └── crud.py                 # Функції для створення, отримання, оновлення, видалення даних
│   ├── models/                     # SQLAlchemy моделі (для взаємодії з базою даних)
│   │   └── models.py               # Моделі для товарів, категорій та користувачів
│   ├── schemas/                    # Схеми для валідації даних за допомогою Pydantic
│   │   └── schemas.py              # Схеми для категорій, товарів, користувачів
│   ├── database.py                 # Налаштування підключення до бази даних (SQLAlchemy)
│   ├── auth.py                     # Логіка для аутентифікації (JWT)
│   ├── config.py                   # Конфігурації для секретних ключів та алгоритмів
│   ├── security.py                 # Логіка для безпеки (паролі, хешування)
│   └── utils.py                    # Допоміжні функції
├── frontend/                       # Фронтенд частина проекту (React)
│   ├── public/                     # Публічні файли (index.html, favicon)
│   ├── src/                        # Джерельний код React
│   │   ├── components/             # Компоненти React (форми, інтерфейси)
│   │   ├── services/               # Сервіси для взаємодії з API
│   │   ├── App.js                  # Основний компонент
│   │   └── index.js                # Точка входу для React
├── tests/                          # Тести для перевірки API
│   ├── test_main.py                # Тести для основних ендпоінтів
│   ├── test_auth.py                # Тести для автентифікації та авторизації
│   └── test_crud.py                # Тести для CRUD операцій
├── init_db.py                      # Ініціалізація бази даних (створення таблиць)
├── .env                            # Файл середовища для продуктивного середовища (БД, секрети)
├── .env.test                       # Файл середовища для тестового середовища
├── Dockerfile                      # Dockerfile для контейнеризації додатку
├── docker-compose.yml              # Docker Compose для запуску в контейнерах
├── requirements.txt                # Залежності для проекту
├── README.md                       # Документація проекту
└── alembic/                        # Налаштування для міграцій БД через Alembic
    └── versions/                   # Міграції БД

## Тести

1. Запуск тестів:
    ```bash
    pytest
    ```

2. Тести покривають:
   - Реєстрацію та автентифікацію
   - CRUD операції для категорій і товарів
   - Перевірку ролей користувачів

## Використання

Для реєстрації нового користувача на сервері потрібно виконати POST запит на `/api/auth/register` з тілами:
```json
{
    "username": "user1",
    "password": "password123",
    "email": "user1@example.com"
}
```

Для входу (отримання JWT токену) слід виконати POST запит на /api/auth/login з тілами:

{
    "username": "user1",
    "password": "password123"
}

## Ліцензія
Цей проект ліцензується під ліцензією MIT
